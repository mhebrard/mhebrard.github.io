---
layout: main
title: Amazon Web Server
description: Setup and usage of AWS
---

# Amazon Web Server (2019-08-27)
Setup and usage of AWS

## Login to Management console (web)
* Visit AWS website at https://aws.amazon.com/console/
* Click on ```Sign In to the Console```
* Enter Credentials

## Create bucket
* From management console, click on ```Storage/S3```
* Click on ```Create bucket```
* Enter a name (no space, no caps, no special character)
* Click on ```Next```
* Select option ```Automatically encrypt objects when they are stored in S3```
* Keep the option ```AES-256``` selected as default
* Click on ```Next```
* Keep the option ```Block all public access``` selected by default
* Click on ```Next```
* Click on ```Create bucket```

## Create a new group
* Visite https://console.aws.amazon.com/iam/
* Click on ```Groups```
* Click on ```Create New Group```
* Enter a group name
* Click on ```Next```
* Select policy
* Click on ```Next Step```
* Click on ```Create Group```

## Create a new user
* Visite https://console.aws.amazon.com/iam/
* Click on ```Users```
* Click on ```Add user```
* Enter a user name
* Check both Access type : ```Programmatic access``` and ```AWS Management Console access```
* Keep option ```Autogenerate password``` selected
* Check ```Require password reset```
* Click on ```Next: Permissions```
* Select a group for the user
* Click on ```Next: Tags```
* Click on ```Next: Review```
* Click on ```Create user```
* Click on ```Download .csv```
* Click on ```Send email```
* Send the email to the new user
* Communicate the credentials to the new user in a separate email

## Connect to AWS with new account
* Check your emails
* Follow the link to ```Sign-in URL```
* Enter IAM user name
* Enter the autogenerated password
* Enter old password
* Enter new password
* Retype new password

## Setup AWS CLI on Linux:
* update pip
```
sudo pip install --index-url=https//pypi.python.org/simple/ --upgrade pip
```
* add pip to $PATH
```
sudo gedit .bashrc
```
> #Add line:
>
> export PATH=$PATH:/usr/local/bin
* install AWS CLI
```
pip install awscli --upgrade --user
```
* add aws to $PATH
```
sudo gedit .bashrc
```
> #Add line:
>
> export PATH=$PATH:~/.local/bin
* configure awscli (change [...] values to fit your credentials, for regions see (https://docs.aws.amazon.com/general/latest/gr/rande.html#apigateway_region)
```
aws configure --profile [myprofile]
[AWS Access KEY ID]
[AWS Secret Access Key]
[region]
text
```

## Explore, Upload & Download AWS s3
* List the buckets
```
aws s3 ls
```
* List files in a bucket
```
aws s3 ls s3://[bucket]
```
* Upload a file on s3
```
aws s3 cp /[pathToFile] s3://[bucket]/[pathToFile]
```
* Download a file from s3
```
aws s3 cp s3://[bucket]/[pathToFile] /[pathToFile] 
```
* Upload a folder on s3
```
aws s3 cp /[pathToFolder] s3://[bucket]/[Folder] --recursive
```
* Download a file from s3
```
aws s3 cp s3://[bucket]/[Folder] /[pathToFolder] --recursive
```
* Sync s3 folder with a local folder (upload and download simultaneously)
```
aws s3 sync s3://[bucket]/[folder] /[pathToLocalFolder]
```

## Transfer Bucket to Glacier
We can configure a bucket to be transfer from S3 to Glacier after few days or even directly after creation. Note that Glacier is not meant to store small files. It is recommanded to create one archive (.tar) to regroup files into one unique object prior to store it to Glacier.
* From management console, click on ```Storage/S3```
* Click on the bucket name
* Click on ```Management```
* Click on ```Lifecycle/Add lifecycle rule```
* Enter a name (toGlacier)
* Click on ```Next```
* Select ```Current version```
* Click on ```Add transition```
* Select ```Transition to Glacier```
* Set to ```0``` days
* Check that you acknowledge the warning message
* Click on ```Next```
* Click on ```Next```
* Click on ```Save```
* Copy archives into the bucket (see section above)

## END